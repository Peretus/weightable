<!-- .friendships[0].friend.weigh_ins[0] - snippet for future feed enhancement -->
<link href='http://fonts.googleapis.com/css?family=Dancing+Script' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>

<h1 id='header'>Lose weight the <span id="handwriting">Gus Chiggins</span> way.</h1>

<!-- Underline will get weird with scaling for mobile, will need to look into this further
 <img id='underline' src="/index/underline.png"/> -->


<div class="gus">
  <img src="/index/gus_chiggins.jpg"/>
  <p>Gus Chiggins</p>
  <p>Weightable Founder & CEO</p>
</div>

<div class="login">
  <h3>Log in to get started.</h3>
    <div class="login_form">
      <%= form_for("user", :url => user_session_path) do |f| %>
        <div><%= f.label :email %><br />
        <%= f.text_field :email, :autofocus => true %></div>

        <div><%= f.label :password %><br />
        <%= f.password_field :password %></div>
        
        <%= f.check_box :remember_me %>
        <%= f.label :remember_me %><br />
        
        <%= f.submit 'Sign in' %>
        <%= link_to "Forgot your password?", new_password_path('user') %>
      <% end %>
    </div>

  <h3>New to Weightable?</h3>
  <!-- Sign in with Facebook -->
  <%= link_to(image_tag("/index/fb.png", :alt => "Sign-in with Facebook"), user_omniauth_authorize_path(:facebook)) %>
  <p>or</p>
  <%= link_to(image_tag("/index/register.png", :alt => "Create a Weightable Account"), new_user_registration_path) %>
</div>















  <tbody>
    <% if current_user %> 
      <% counter = 0 %>
      <% while counter < 4 %>
        <% @user.friendships.each do |friendship| %>
          <% if counter < friendship.friend.weigh_ins.count %>
            <tr>
              <td><%= friendship.friend.name %></td>
              <td>Pounds to go:<%= (friendship.friend.weigh_ins[counter].weight - friendship.friend.goal) %></td>
              <% if friendship.friend.weigh_ins.count > 1 %>
                <td>Progress since first check-in:<%= ((friendship.friend.weigh_ins[counter-1].weight.to_f / friendship.friend.weigh_ins[counter].weight.to_f) * 100 - 100).round(2) %>%</td>
              <% end %>
              <td>Progress toward goal:<%= ((friendship.friend.weigh_ins[counter].weight.to_f / friendship.friend.goal.to_f) * 100 - 100).round(2) %>%</td>
              <td><%= friendship.friend.weigh_ins[counter].status %></td>
            </tr>
          <% end %>
        <% end %>
      <% counter+=1 %>
      <% end %>
    <% end %>
  </tbody>
</table>

<br>

<% if user_signed_in? %>
Signed in as <%= current_user.name %>. Not you?
<%= link_to "Sign out", destroy_user_session_path,:method => :delete %>
<% else %>
<%= link_to "Sign in", new_user_session_path %> <br> or

<%= link_to "Sign up", new_user_registration_path %> 

<% end %>
<% if current_user %>
  <%= render 'initial_info_modal' %>
<% end %>
<script type='text/javascript'>
  $(document).on('ready', function(e){
    $('#myModal').modal();
  });
</script>